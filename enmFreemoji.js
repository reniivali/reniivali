function p(o){window.enmity.plugins.registerPlugin(o)}const s={byProps:(...o)=>window.enmity.modules.filters.byProps(...o),byName:(o,n)=>window.enmity.modules.filters.byName(o,n),byTypeName:(o,n)=>window.enmity.modules.filters.byTypeName(o,n),byDisplayName:(o,n)=>window.enmity.modules.filters.byDisplayName(o,n)};function h(...o){return window.enmity.modules.bulk(...o)}window.enmity.modules.common,window.enmity.modules.common.Constants,window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const g=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native,window.enmity.modules.common.React,window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function N(o){return window.enmity.patcher.create(o)}var v="Freemoji",b="Send external emoji without Nitro as image links",f="2.0.0",S="#f9a418",E=[{name:"FifiTheBulldog",id:"690213339862794285"}],P={name:v,description:b,version:f,color:S,authors:E};const m=N("freemoji"),[d,w,{getChannel:j}]=h(s.byProps("canUseEmojisEverywhere","canUseAnimatedEmojis"),s.byProps("openLazy","hideActionSheet"),s.byProps("getChannel"));var A=(o=>(o[o.None=0]="None",o[o.Classic=1]="Classic",o[o.Nitro=2]="Nitro",o))(A||{}),k=(o=>(o[o.PNG=0]="PNG",o[o.APNG=1]="APNG",o[o.Lottie=2]="Lottie",o))(k||{});const C={...P,onStart(){let o=!0;m.before(w,"openLazy",(c,[,t,{pickerIntention:a}])=>{switch(t){case"EmojiPickerActionSheet":if(a!==0)break;case"MessageLongPressActionSheet":o=!1}}),m.after(w,"hideActionSheet",()=>{o=!0});const n=m.before(d,"canUseEmojisEverywhere",(c,[{premiumType:t}])=>{n(),(t!=null?t:0)===0&&(m.instead(d,"canUseEmojisEverywhere",()=>o),m.instead(d,"canUseAnimatedEmojis",()=>o),m.before(g,"sendMessage",(a,[r,i])=>{const u=j(r);i.validNonShortcutEmojis.forEach((e,y)=>{var l;(e.guildId!==u.guild_id||e.animated)&&(i.content=i.content.replace(`<${e.animated?"a":""}:${(l=e.originalName)!=null?l:e.name}:${e.id}>`,e.url.replace("webp","png").replace(/size=\d+/,"size=128")),delete i.validNonShortcutEmojis[y])}),i.validNonShortcutEmojis=i.validNonShortcutEmojis.filter(e=>e)}))})},onStop(){m.unpatchAll()}};p(C);